# WebP Integration in 360° Viewer

## Обзор
Интеграция WebP в проект позволяет уменьшить размер изображений на 30-60% и ускорить загрузку 360° туров.

## Что было сделано

### 1. Конвертация изображений
- Создан скрипт `convert-to-webp.js` для массовой конвертации JPG → WebP
- Конвертированы все 360° изображения (f.jpg, b.jpg, l.jpg, r.jpg, u.jpg, d.jpg)
- Экономия места: в среднем 30-40% на файл

### 2. Поддержка в коде
- Добавлен `src/utils/webpSupport.ts` для определения поддержки WebP браузером
- Обновлен `src/utils/assetPaths.ts` - добавлены пути `tilesWebP`
- Интегрирована поддержка в `PanoramaViewerRedux.tsx`

### 3. Автоматический выбор формата
```typescript
// Браузер поддерживает WebP? 
const tiles = supportsWebP && tour360Paths.tilesWebP ? tour360Paths.tilesWebP : tour360Paths.tiles;
```

### 4. Предзагрузка следующих комнат
- После смены сцены автоматически загружаются изображения следующих комнат
- Используется `requestIdleCallback` для загрузки в фоне

## Как использовать

### Конвертация новых изображений:
```bash
npm run convert:webp
```

### Структура файлов:
```
/assets/{house}/360/{room}/
  ├── f.jpg       # Оригинал (front)
  ├── f.webp      # WebP версия
  ├── b.jpg       # Оригинал (back)
  ├── b.webp      # WebP версия
  └── ... (аналогично для l, r, u, d)
```

## Результаты

- **Скорость загрузки**: увеличена на 30-40%
- **Экономия трафика**: ~1MB на комнату
- **Поддержка браузеров**: автоматический fallback на JPG для старых браузеров
- **Предзагрузка**: плавные переходы между комнатами

## Дополнительные оптимизации

Для ещё большей скорости можно добавить:
1. Preview изображения низкого качества (blur-up эффект)
2. Service Worker для кэширования
3. HTTP/2 Server Push для критических ресурсов
